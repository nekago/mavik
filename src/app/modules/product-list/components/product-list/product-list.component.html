<!--<ul>-->
<!--  <li *ngFor="let product of productList">-->
<!--    <a [routerLink]="product.id + ''">{{product.name}}</a>-->
<!--  </li>-->
<!--</ul>-->

<app-breadcrumbs></app-breadcrumbs>

<button class="filter-btn" (click)="toggleIsShowFilter()" *ngIf="!isShowFilter">
  <i class="fas fa-filter"></i>
</button>

<div class="product-list" [class.overlay]="isShowFilter" *ngIf="productList; else loader">
  <div class="container">
    <div class="container-loader" *ngIf="isLoadingProductList$ | async">
      <app-loader></app-loader>
    </div>
    <div class="product-list__info">
      <img class="product-list__info-img" src="assets/icons/product-list/{{slugName}}-icon.png" alt="{{slugName}}-icon">
      <div class="product-list__info-name">{{categoryName}}</div>
      <div class="product-list__info-count"> ({{cheese20}})</div>
      <div class="filter-tag" *ngIf="(filterTags$ | async)?.length">
        <button (click)="resetFilter()" class="filter-tag__reset">Очистити фільтри
          <img src="assets/icons/btn-reset.svg" alt="btn-reset"></button>
        <div *ngFor="let tag of filterTags$ | async">
          <button (click)="deleteFilterTag(tag)"
                  class="filter-tag__close">{{tag[1]}}
            <img src="assets/icons/btn-close.svg" alt="btn-close"></button>
        </div>
      </div>
    </div>

    <div class="product-list__inner">
      <div class="product-list__filters" [class.show]="isShowFilter">
        <button class="close-btn" (click)="toggleIsShowFilter()"><i class="fas fa-close"></i></button>
        <h1 class="product-list__filters-title">Фільтри</h1>

        <div>
          <h2 class="product-list__filters-head">Ціна</h2>
          <ngx-slider
            [(value)]="minPriceValue"
            [(highValue)]="maxPriceValue"
            [options]="options"
            (userChangeStart)="setPriceRange($event,'min')"
            (userChangeEnd)="setPriceRange($event, 'max')"
          ></ngx-slider>
        </div>


        <div *ngFor="let filterGroup of filterState$ | async">
          <h2 class="product-list__filters-head">{{filterGroup?.key}}</h2>
          <div class="product-list__filters-value" *ngFor="let filterField of filterGroup?.values">
            <label class="filter__container" [class.disabled]="!filterField.isChecked && !filterField.isActive"
                   [for]="filterGroup.key + '_' + filterField.value">
              {{filterField.value || 'test'}}
              <input
                type="checkbox"
                checked="checked"
                (input)="toggleFilterValue(filterGroup.key_en, filterField, $event)"
                [id]="filterGroup.key + '_' + filterField.value"
                [disabled]="!filterField.isChecked && !filterField.isActive"
                [checked]="filterField.isChecked"
              >
              <span class="checkmark" [class.disabled]="filterFieldIsDisable(filterField)"></span>
            </label>
          </div>

        </div>
      </div>
      <div class="products" *ngIf="productList.length; else productListEmpty">
        <div class="products__inner">
          <app-product-card *ngFor="let product of productList" [product]="product"></app-product-card>
        </div>
      </div>
      <ng-template #productListEmpty>
        <div class="product-list-empty">
          <h1 class="title title-one">Не знайдено жодного товару</h1>
        </div>
      </ng-template>

    </div>
    <div class="pagination">

      <button class="pagination__page arrow" (click)="changePage('first')" [disabled]="currentPage === 1"><i
        class="fas fa-angles-left"></i></button>
      <div [ngSwitch]="paginationState()">
        <div *ngSwitchCase="'start'">
          <button class="pagination__page" (click)="changePage(page)" *ngFor="let page of pages | slice:0:4"
                  [class.active]="page === +currentPage">
            {{page}}
          </button>
          <button class="pagination__page">
            ...
          </button>
          <button class="pagination__page" (click)="changePage(pagesCount)">
            {{pagesCount}}
          </button>
        </div>

        <div *ngSwitchCase="'middle'">
          <button class="pagination__page" (click)="changePage(1)">
            1
          </button>
          <button class="pagination__page">
            ...
          </button>
          <button class="pagination__page" (click)="changePage(page)"
                  *ngFor="let page of pages | slice:currentPage - 2: +currentPage + 1"
                  [class.active]="page === +currentPage">
            {{page}}
          </button>
          <button class="pagination__page">
            ...
          </button>
          <button class="pagination__page" (click)="changePage(pagesCount)">
            {{pagesCount}}
          </button>
        </div>

        <div *ngSwitchCase="'end'">
          <button class="pagination__page" (click)="changePage(1)">
            1
          </button>
          <button class="pagination__page">
            ...
          </button>
          <button class="pagination__page" (click)="changePage(page)" *ngFor="let page of pages | slice:pagesCount - 4"
                  [class.active]="page === +currentPage">
            {{page}}
          </button>
        </div>

        <div *ngSwitchCase="'all'">
          <button class="pagination__page" (click)="changePage(page)" *ngFor="let page of pages"
                  [class.active]="page === +currentPage">
            {{page}}
          </button>
        </div>

      </div>
      <button class="pagination__page arrow" (click)="changePage('last')" [disabled]="currentPage === pagesCount"><i
        class="fas fa-angles-right"></i></button>
    </div>

  </div>
</div>

<ng-template #loader>
  <app-loader></app-loader>
</ng-template>
